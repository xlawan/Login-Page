<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Accounts</title>
        <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
        <!-- <link rel="stylesheet" src="./assets/style.css"> -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.3/angular.min.js"></script>
        <style>
            #camera {
            width: 160px;
            height: 120px;
            border: 1px solid black;
            }
            #webcamModal div {
            display: flex;
            flex-direction: column;
            align-items: center;
            }
            #webcamModal img {
                height: 120px;
                width: 160px;
            }
            #webcamModal button {
                display: block;
                padding: 10px;
                margin-top: 10px;
            }
        </style>
    </head>
    <body>    
        <div class = "w3-bar w3-blue">
            <div class="w3-left" style="margin-left: 20px; margin-top: 10px;">
                <h3>STUDENT AND USER MANAGEMENT</h3>
            </div>
            <div class="w3-bar-item w3-right">
                <button class ="w3-button w3-right w3-red w3-round-large" onclick="logout()" style="margin-left: 10px;">LOG-OUT</button>
                <button class="w3-button w3-right w3-green w3-round-large" onclick="document.getElementById('registrationModalUser').style.display='block'; showUserTable()" style="margin-left: 10px;">ADD User</button>
                <button class="w3-button w3-right w3-indigo w3-round-large" onclick="document.getElementById('registrationModalStudent').style.display='block'; showStudentTable()">ADD Student</button>
            </div>
        </div>
        <div class="w3-center">
            <button class="w3-button w3-indigo" onclick="showStudentTable()">Show Students Table</button>
            <button class="w3-button w3-green" onclick="showUserTable()">Show Users Table</button>
            <button class="w3-button w3-pink" onclick="showAllTable()">Show All Table</button>
        </div>
        <div ng-app="app">
            <div ng-controller="students">
                <!--Students Table-->
                <div id="studentTable" style="display:block;">
                    <table class="w3-table-all">
                        <thead>
                            <tr class="w3-blue">
                                <th ng-repeat="h in header" class="w3-center">{{ h | uppercase }}</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="x in students">
                                <td class="w3-center">{{ x.idno }}</td>
                                <td class="w3-center">{{ x.lastname }}</td>
                                <td class="w3-center">{{ x.firstname }}</td>
                                <td class="w3-center">{{ x.course }}</td>
                                <td class="w3-center">{{ x.level }}</td>
                                <td class="w3-center"><img src="/assets/images/{{x.image}}" alt="{{x.image}}" width="50" height="50"></td>
                                <td class="w3-center">
                                    <button type="submit" class="w3-button w3-yellow w3-round-large" ng-click="showDataStudent(x.idno, x.lastname, x.firstname, x.course, x.level)" onclick="document.getElementById('editModalStudent').style.display='block'">&#9998;</button>
                                    &emsp;
                                    <button type="submit" class="w3-button w3-red w3-round-large" ng-click="deleteStudent(x.idno)">&#10007;</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <!--Add Student modal-->
                <div class="w3-modal" id="registrationModalStudent">
                    <div class="w3-modal-content w3-animate-top" style="width:400px">
                        <div class="w3-container w3-blue">
                            <span class="w3-button w3-display-topright" onclick="document.getElementById('registrationModalStudent').style.display='none'">&times;</span>
                            <h3>Add New Student</h3>
                        </div>
                        <form method="POST" action="/students" enctype="multipart/form-data" class="w3-container w3-padding-16">
                                <label for = "idno">ID</label>
                                <input type ="number" id ="idno" name="idno" class = "w3-input w3-border" ng-model="idno" placeholder="Not required">
                                <label for = "lastname">LASTNAME</label>
                                <input type ="text" id ="lastname" name="lastname" class = "w3-input w3-border" ng-model="lastname">
                                <label for = "firstname">FIRSTNAME</label>
                                <input type ="text" id ="firstname" name="firstname" class = "w3-input w3-border" ng-model="firstname">
                                <label for = "course">COURSE</label>
                                <input type ="text" id ="course" name="course" class = "w3-input w3-border" ng-model="course">
                                <label for = "level">LEVEL</label>
                                <input type ="text" id ="level" name="level" class = "w3-input w3-border" ng-model="level">
                                <label for = "image">Picture</label>
                                <input type="file" id="file_input" name="image" ng-model="image" accept="image/png, image/jpeg, image/jpg">
                                <br>or
                                <input type="button" value="Webcam" onclick="document.getElementById('webcamSection').style.display='block'"><br><br>
                                <div id="webcamSection" style="display: none;" class="">
                                    <div id="camera" ></div>
                                    <img id="myImg" style="display: none;" src="">
                                    <input
                                        type="button" 
                                        id="takeSnapshot"
                                        onclick="take_snapshot();document.getElementById('myImg').style.display='block';
                                            document.getElementById('loadUrl').style.display='block';
                                            document.getElementById('camera').style.display='none';
                                            document.getElementById('retakeButton').style.display='block';
                                            document.getElementById('takeSnapshot').style.display='none'"
                                        value="Take Snapshot" />
                                    
                                    <input
                                        type="button" 
                                        id="retakeButton" 
                                        style="display: none;" 
                                        onclick="document.getElementById('takeSnapshot').style.display='block'; 
                                            document.getElementById('camera').style.display='block';
                                            document.getElementById('myImg').style.display='none';
                                            document.getElementById('retakeButton').style.display='none';
                                            document.getElementById('loadUrl').style.display='none';"
                                        value="Retake">
                                    
                                    
                                    <input type="button" id="loadUrl" value="SAVE" style="display: none;" onclick="document.getElementById('webcamSection').style.display='none'" />
                                    <br>
                                    <!-- <img id="myImg" style="display: none;" src=""> -->
                                    <input id='url' type="text" style="display: none;" value="">
                                    <br>
                                    <input type="button" id="loadUrl" value="SAVE" style="display: none;" onclick="document.getElementById('webcamModal').style.display='none'" />
                                    <!-- <input id='file_input' name="image" type="file"> -->
                                    <!-- <span>status input file type: <span id="status"></span></span> -->
                                </div>
        
                            <button type="submit" class="w3-right w3-button w3-blue" ng-click="addStudent()">Add Student</button>
                            <input type="button" class="w3-left w3-button w3-blue" value="Clear" ng-click="clearAllStudent()"></button>
                        </form>
                    </div>
                </div>
                <!-- webcam modal -->
                <!-- <div class="w3-modal" id="webcamModal">
                    <div class="w3-modal-content w3-animate-top " style="width:50%">
                        <div class="w3-container w3-blue">
                            <span class="w3-button w3-display-topright" onclick="document.getElementById('webcamModal').style.display='none'">&times;</span>
                            <h3>Webcam 1.0</h3>
                        </div>
                        <div class="w3-container w3-padding-16">
                            <div id="camera" ></div>
                            <img id="myImg" style="display: none;" src="">
                            <button 
                                id="takeSnapshot"
                                onclick="take_snapshot();document.getElementById('myImg').style.display='block';
                                    document.getElementById('loadUrl').style.display='block';
                                    document.getElementById('camera').style.display='none';
                                    document.getElementById('retakeButton').style.display='block';
                                    document.getElementById('takeSnapshot').style.display='none'">
                                Take Snapshot
                            </button>
                            <button 
                                id="retakeButton" 
                                style="display: none;" 
                                onclick="document.getElementById('takeSnapshot').style.display='block'; 
                                    document.getElementById('camera').style.display='block';
                                    document.getElementById('myImg').style.display='none';
                                    document.getElementById('retakeButton').style.display='none';
                                    document.getElementById('loadUrl').style.display='none';
                                    ">
                                Retake
                            </button>
                            <br>
                            <input type="button" id="loadUrl" value="SAVE" style="display: none;" onclick="document.getElementById('webcamModal').style.display='none'" />
                            <br> -->
                            <!-- <img id="myImg" style="display: none;" src="">
                            <input id='url' type="text" style="display: none;" value="">
                            <br>
                            <input type="button" id="loadUrl" value="SAVE" style="display: none;" onclick="document.getElementById('webcamModal').style.display='none'" />
                            <input id='file_input' name="image" type="file">
                            <span>status input file type: <span id="status"></span></span>
                        </div>
                    </div>
                </div> -->

                <!--Edit Student modal-->
                <div class="w3-modal" id="editModalStudent">
                    <div class="w3-modal-content w3-animate-top" style="width:400px">
                        <div class="w3-container w3-blue">
                            <span class="w3-button w3-display-topright" onclick="document.getElementById('editModalStudent').style.display='none'">&times;</span>
                            <h3>Edit Student</h3>
                        </div>
                        <!-- <form method="PUT" action="/students" enctype="multipart/form-data" class="w3-container w3-padding-16"> -->
                        <div class="w3-container w3-padding-16">
                            <label for = "idno">ID</label>
                            <input type ="number" name="idno" id ="idno" class = "w3-input w3-border" ng-model="idno" readonly>
                            <label for = "lastname">LASTNAME</label>
                            <input type ="text" id ="lastname" name="lastname" class = "w3-input w3-border" ng-model="lastname">
                            <label for = "firstname">FIRSTNAME</label>
                            <input type ="text" id ="firstname" name="firstname" class = "w3-input w3-border" ng-model="firstname">
                            <label for = "course">COURSE</label>
                            <input type ="text" id ="course" name="course" class = "w3-input w3-border" ng-model="course">
                            <label for = "level">LEVEL</label>
                            <input type ="text" id ="level" name="level" class = "w3-input w3-border" ng-model="level">
                            <!-- <label for = "image">Picture</label>
                            <input type="file" id="image" name="image" ng-model="image" accept="image/png, image/jpeg, image/jpg" required><br>                           -->
                            <br><br>
                            <button class="w3-right w3-button w3-blue" ng-click="updateStudent()">Update</button>
                            <button class="w3-left w3-button w3-blue" ng-click="clearWithoutIdStudent()">Clear</button>
                        </div>
                        <!-- </form> -->
                    </div>
                </div>
            </div>
            <div ng-controller="users">
                <!--Users Table-->
                <div id="userTable" style="display:none;">
                    <table class="w3-table-all">
                        <thead>
                            <tr class="w3-blue">
                                <th ng-repeat="h in header" class="w3-center">{{ h | uppercase }}</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="x in users">
                                <td class="w3-center">{{ x.id }}</td>
                                <td class="w3-center">{{ x.username }}</td>
                                <td class="w3-center">{{ x.password }}</td>
                                <td class="w3-center">
                                    <button type="submit" class="w3-button w3-yellow w3-round-large" ng-click="showDataUser(x.id, x.username, x.password)" onclick="document.getElementById('editModalUser').style.display='block'">&#9998;</button>
                                    &emsp;
                                    <button type="submit" class="w3-button w3-red w3-round-large" ng-click="deleteUser(x.id)">&#10007;</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <!--Add user modal-->
                    <div class="w3-modal" id="registrationModalUser">
                        <div class="w3-modal-content w3-animate-top" style="width:400px">
                            <div class="w3-container w3-blue">
                                <span class="w3-button w3-display-topright" onclick="document.getElementById('registrationModalUser').style.display='none'">&times;</span>
                                <h3>Add New User</h3>
                            </div>
                            <div class="w3-container w3-padding-16">
                                    <label for = "idno">ID</label>
                                    <input type ="number" id ="id" class = "w3-input w3-border" ng-model="id" placeholder="Not required">
                                    <label for = "username">USERNAME</label>
                                    <input type ="text" id ="username" class = "w3-input w3-border" ng-model="username">
                                    <label for = "password">PASSWORD</label>
                                    <input type ="text" id ="password" class = "w3-input w3-border" ng-model="password">
                                <br>
                                <button class="w3-right w3-button w3-blue" ng-click="addUser()">Add User</button>
                                <button class="w3-left w3-button w3-blue" ng-click="clearAllUser()">Clear</button>
                            </div>
                        </div>
                    </div>
                    <!--Edit User modal-->
                    <div class="w3-modal" id="editModalUser">
                        <div class="w3-modal-content w3-animate-top" style="width:400px">
                            <div class="w3-container w3-blue">
                                <span class="w3-button w3-display-topright" onclick="document.getElementById('editModalUser').style.display='none'">&times;</span>
                                <h3>Edit Student</h3>
                            </div>
                            <div class="w3-container w3-padding-16">
                                <label for = "idno">ID</label>
                                <input type ="number" id ="id" class = "w3-input w3-border" ng-model="id" readonly>
                                <label for = "username">USERNAME</label>
                                <input type ="text" id ="username" class = "w3-input w3-border" ng-model="username">
                                <label for = "password">PASSWORD</label>
                                <input type ="text" id ="password" class = "w3-input w3-border" ng-model="password">
                                <br>
                                <button class="w3-right w3-button w3-blue" ng-click="updateUser()">Update</button>
                                <button class="w3-left w3-button w3-blue" ng-click="clearWithoutIdUser()">Clear</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/webcamjs/1.0.26/webcam.min.js"></script>
    <script src="./assets/script.js"></script>
    <script src="./assets/index.js"></script>
    <script>
        function showStudentTable(){
            document.getElementById("studentTable").style.display='block';
            document.getElementById("userTable").style.display='none';
        }
        function showUserTable(){
            document.getElementById("studentTable").style.display='none';
            document.getElementById("userTable").style.display='block';
        }
        function showAllTable(){
            document.getElementById("studentTable").style.display='block';
            document.getElementById("userTable").style.display='block';
        }
        // load webcam
        Webcam.set({
            width:160,
            height:120,
            image_format:'jpeg',
            jpeg_quality:90
        })
        Webcam.attach("#camera")

        function take_snapshot(){
            Webcam.snap(function(data_uri){
                // document.getElementById("results").innerHTML = 
                // '<img id="hello" src="'+data_uri+'" >';
                document.getElementById("myImg").src = data_uri;
                document.getElementById("url").value = data_uri;
                // document.getElementById("inputFile").src = "fileName";
                // console.log(data_uri)
            })
        }
        //end of webcam code
    </script>
</html>

